<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Witch's Evaluation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #0b0b0f;
            --glass: rgba(255, 255, 255, 0.08);
            --gold: #FFD700;
            --purple: #9d4edd;
            --text: #f0f0f0;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0;
            background: var(--bg);
            color: var(--text);
            font-family: 'Montserrat', sans-serif;
            height: 100dvh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- BACKGROUND --- */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.4;
        }
        .orb-1 { top: -10%; left: -10%; width: 300px; height: 300px; background: var(--purple); animation: float 10s infinite; }
        .orb-2 { bottom: -10%; right: -10%; width: 250px; height: 250px; background: #681111; animation: float 12s infinite reverse; }

        @keyframes float { 0% { transform: translate(0,0); } 50% { transform: translate(30px, 50px); } 100% { transform: translate(0,0); } }

        /* --- PROGRESS BAR --- */
        .progress-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 6px;
            background: rgba(255,255,255,0.1);
            z-index: 100;
        }
        .progress-bar {
            height: 100%; width: 0%;
            background: linear-gradient(90deg, var(--gold), #ffaa00);
            transition: width 0.4s ease;
            box-shadow: 0 0 10px var(--gold);
        }

        /* --- SCREENS --- */
        .screen {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            padding: 24px;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            opacity: 0; visibility: hidden;
            transition: opacity 0.4s;
        }
        .screen.active { opacity: 1; visibility: visible; z-index: 10; }

        /* --- TYPOGRAPHY --- */
        h1, h2 { font-family: 'Cinzel', serif; text-align: center; color: var(--gold); margin-bottom: 20px; }
        h1 { font-size: 2rem; }
        h2 { font-size: 1.5rem; line-height: 1.4; }
        p { text-align: center; line-height: 1.6; color: #ccc; margin-bottom: 30px; }

        /* --- QUIZ OPTIONS GRID --- */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            width: 100%;
            max-width: 400px;
        }

        .option-btn {
            background: var(--glass);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 16px;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            text-align: left;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .option-btn:active { transform: scale(0.98); background: rgba(255, 215, 0, 0.2); border-color: var(--gold); }
        
        /* --- INPUTS --- */
        .magic-input {
            width: 100%;
            background: rgba(0,0,0,0.3);
            border: 1px solid #444;
            padding: 15px;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            margin-bottom: 15px;
            font-family: 'Montserrat', sans-serif;
        }
        .magic-input:focus { outline: none; border-color: var(--gold); }

        .big-btn {
            background: var(--gold);
            color: #000;
            border: none;
            width: 100%;
            padding: 18px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
            margin-top: 20px;
        }

        /* --- ANIMATIONS --- */
        .fade-up { animation: fadeUp 0.5s ease forwards; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <audio id="bg-music" loop>
        <source src="https://ia801308.us.archive.org/27/items/HarryPotter-hedwigstheme/Harry_Potter_Theme_Song_Hedwigs_Theme.mp3" type="audio/mpeg">
    </audio>

    <div class="progress-container"><div class="progress-bar" id="bar"></div></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <div id="screen-intro" class="screen active">
        <h1 style="font-size: 3rem;">O.W.L.s</h1>
        <p style="font-size: 1.2rem;">Official Wizarding Level Assessment</p>
        <p>You have completed the journey. Now, let us assess what kind of witch you truly are.</p>
        <button class="big-btn" onclick="startQuiz()">Begin Assessment</button>
    </div>

    <div id="screen-quiz" class="screen">
        <h2 id="q-text">Question Text</h2>
        <div class="options-grid" id="options-container">
            </div>
    </div>

    <div id="screen-reveal" class="screen">
        <h2 style="color: #fff; font-size: 1.2rem; opacity: 0.8;">ASSESSMENT COMPLETE</h2>
        <h1 style="font-size: 2.5rem; margin: 10px 0;">RESULT: 99%</h1>
        <h2 style="color: var(--gold);">HERMIONE GRANGER</h2>
        
        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 3px solid var(--gold);">
            <p style="margin: 0; font-style: italic; color: #fff;">"Now you know why I call you that."</p>
            <p style="margin-top: 15px; font-size: 0.95rem;">Because you have her loyalty. You have her brilliance. And most importantly, you have the heart that kept everyone else going.</p>
        </div>

        <button class="big-btn" onclick="goToAddress()">Claim Certification</button>
    </div>

    <div id="screen-address" class="screen">
        <h2>Apparition Coordinates</h2>
        <p style="font-size: 0.9rem;">To dispatch your official assessment results and certification, the Ministry requires your current Muggle dwelling coordinates.</p>
        
        <div style="width: 100%; overflow-y: auto; padding-bottom: 20px;">
            <input type="text" id="name" class="magic-input" placeholder="Full Wizarding Name">
            <input type="tel" id="mobile" class="magic-input" placeholder="Owl Link (Mobile)">
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <input type="number" id="pin" class="magic-input" placeholder="Rune Code (PIN)">
                <input type="text" id="state" class="magic-input" placeholder="Region (State)">
            </div>
            
            <input type="text" id="house" class="magic-input" placeholder="Dwelling No. & Building">
            <input type="text" id="area" class="magic-input" placeholder="Sector / Street">
            <input type="text" id="city" class="magic-input" placeholder="Stronghold (City)">
            
            <button class="big-btn" id="submit-btn" onclick="submitFinal()">Summon Owl</button>
            <p id="loading" style="display: none; color: var(--gold); margin-top: 10px;">Establishing Magical Link...</p>
        </div>
    </div>

    <div id="screen-final" class="screen">
        <h1>Owl Dispatched</h1>
        <p>Your coordinates have been locked.</p>
        <p style="color: var(--gold); font-size: 1.2rem;">"Mischief Managed"</p>
    </div>

    <script>
        // --- EMAILJS CONFIG ---
        const PUBLIC_KEY = 'YOUR_PUBLIC_KEY'; 
        const SERVICE_ID = 'YOUR_SERVICE_ID';
        const TEMPLATE_ID = 'YOUR_TEMPLATE_ID';

        (function(){ emailjs.init(PUBLIC_KEY); })();

        // --- THE QUIZ DATA (10 QUESTIONS) ---
        const questions = [
            {
                q: "Which Hogwarts House do you truly belong to?",
                o: ["Gryffindor (Brave)", "Ravenclaw (Wise)", "Slytherin (Ambitious)", "Hufflepuff (Loyal)"]
            },
            {
                q: "Be honest. Ron or Harry?",
                o: ["Ron (The Heart)", "Harry (The Hero)", "Both in different ways", "Neither, I like Draco"]
            },
            {
                q: "Which death hurt you the most?",
                o: ["Dobby", "Sirius Black", "Snape", "Fred Weasley"]
            },
            {
                q: "If you could use one spell in real life?",
                o: ["Accio (Summoning)", "Alohomora (Unlocking)", "Obliviate (Forgetting)", "Expecto Patronum"]
            },
            {
                q: "What did you think of Snape in the end?",
                o: ["A hero", "Still a bully", "Complicated", "The bravest man ever"]
            },
            {
                q: "Favorite Professor?",
                o: ["McGonagall", "Lupin", "Snape", "Dumbledore"]
            },
            {
                q: "Which magical object would you keep?",
                o: ["Invisibility Cloak", "Time Turner", "Elder Wand", "Marauder's Map"]
            },
            {
                q: "How was the movie watching experience?",
                o: ["Magical âœ¨", "Emotional ðŸ˜¢", "Long but worth it", "Best journey ever"]
            },
            {
                q: "Who was the best villain?",
                o: ["Voldemort", "Bellatrix", "Umbridge (I hate her)", "Draco (Misunderstood)"]
            },
            {
                q: "One word to describe the ending?",
                o: ["Perfect", "Bittersweet", "Heartbreaking", "Always"]
            }
        ];

        let currentQ = 0;
        let answers = {};

        // --- FUNCTIONS ---

        function startQuiz() {
            document.getElementById('bg-music').play().catch(e=>console.log("Audio requires interaction"));
            switchScreen('screen-intro', 'screen-quiz');
            renderQuestion();
        }

        function renderQuestion() {
            const qData = questions[currentQ];
            const qText = document.getElementById('q-text');
            const ctn = document.getElementById('options-container');
            const bar = document.getElementById('bar');

            // Animate Out
            gsap.to([qText, ctn], { opacity: 0, y: -10, duration: 0.2, onComplete: () => {
                // Update Data
                qText.innerText = qData.q;
                ctn.innerHTML = '';
                
                // Create Buttons
                qData.o.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = opt;
                    btn.onclick = () => selectOption(qData.q, opt);
                    ctn.appendChild(btn);
                });

                // Update Bar
                const pct = ((currentQ) / questions.length) * 100;
                bar.style.width = pct + '%';

                // Animate In
                gsap.fromTo([qText, ctn], { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 0.3, stagger: 0.1 });
            }});
        }

        function selectOption(question, answer) {
            answers[`Q${currentQ+1}`] = answer; // Save answer
            
            // Sparkle Effect
            // (Simple visual feedback handled by CSS active state)

            currentQ++;
            if(currentQ < questions.length) {
                renderQuestion();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            document.getElementById('bar').style.width = '100%';
            switchScreen('screen-quiz', 'screen-reveal');
        }

        function goToAddress() {
            switchScreen('screen-reveal', 'screen-address');
        }

        function switchScreen(fromId, toId) {
            const from = document.getElementById(fromId);
            const to = document.getElementById(toId);
            
            gsap.to(from, { opacity: 0, scale: 0.95, duration: 0.4, onComplete: () => {
                from.classList.remove('active');
                to.classList.add('active');
                gsap.fromTo(to, { opacity: 0, scale: 1.05 }, { opacity: 1, scale: 1, duration: 0.4 });
            }});
        }

        function submitFinal() {
            // Collect Address
            const finalData = {
                ...answers, // Includes all quiz answers
                name: document.getElementById('name').value,
                mobile: document.getElementById('mobile').value,
                pin: document.getElementById('pin').value,
                state: document.getElementById('state').value,
                house: document.getElementById('house').value,
                area: document.getElementById('area').value,
                city: document.getElementById('city').value
            };

            if(!finalData.name || !finalData.pin || !finalData.house) {
                gsap.to('#screen-address', { x: 10, duration: 0.1, yoyo: true, repeat: 5 });
                return;
            }

            document.getElementById('submit-btn').style.display = 'none';
            document.getElementById('loading').style.display = 'block';

            emailjs.send(SERVICE_ID, TEMPLATE_ID, finalData)
                .then(() => {
                    switchScreen('screen-address', 'screen-final');
                }, (err) => {
                    alert("Owl Network Error. Please screenshot this page.");
                    document.getElementById('submit-btn').style.display = 'block';
                    document.getElementById('loading').style.display = 'none';
                });
        }
    </script>
</body>
</html>
